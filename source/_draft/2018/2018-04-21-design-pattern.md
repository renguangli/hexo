---
layout: post
title: Java设计模式(零) - 概述
category: 设计模式
tags: [设计模式]
---

设计模式（Design pattern）代表了最佳的实践，通常被有经验的面向对象的软件开发人员所采用。设计模式是软件开发人员在软件开发过程中面临的一般问题的解决方案。这些解决方案是众多软件开发人员经过相当长的一段时间的试验和错误总结出来的。

## 概述

设计模式是一套被反复使用的、多数人知晓的、经过分类编目的、代码设计经验的总结。使用设计模式是为了重用代码、让代码更容易被他人理解、保证代码可靠性。 毫无疑问，设计模式于己于他人于系统都是多赢的，设计模式使代码编制真正工程化，设计模式是软件工程的基石，如同大厦的一块块砖石一样。项目中合理地运用设计模式可以完美地解决很多问题，每种模式在现实中都有相应的原理来与之对应，每种模式都描述了一个在我们周围不断重复发生的问题，以及该问题的核心解决方案，这也是设计模式能被广泛应用的原因。

## 分类

设计模式分为三大类，23 种：

- 创建型模式，共五种：工厂方法模式、抽象工厂模式、单例模式、建造者模式、原型模式。

- 结构型模式，共七种：适配器模式、装饰器模式、代理模式、外观模式、桥接模式、组合模式、享元模式。

- 行为型模式，共十一种：策略模式、模板方法模式、观察者模式、迭代子模式、责任链模式、命令模式、备忘录模式、状态模式、访问者模式、中介者模式、解释器模式。

## 设计原则

### 开闭原则

此原则是由Bertrand Meyer提出的。就是说模块应对扩展开放，而对修改关闭。

### 里氏代换原则

里氏代换原则是由Barbara Liskov提出的。如果调用的是父类的话，那么换成子类也完全可以运行。

### 依赖倒转原则

指在软件里面，把父类都替换成它的子类，程序的行为没有变化。简单的说，子类型能够替换掉它们的父类型。依赖性倒转其实可以说是面向对象设计的标志，用哪种语言编程并不是很重要

### 接口隔离原则

每一个接口应该是一种角色，不多不少，不干不该干的事，该干的事都要干

### 最少知识原则

也叫迪米特法则。不要和陌生人说话，即一个对象应对其他对象有尽可能少的了解。

## 看懂 UML 类图

我们看下面的例子

![uml实例](https://rgl-1252211075.cos.ap-beijing.myqcloud.com/uml/uml.png)
- Vehicle 表示一个接口；
- Car 和 Bike 实现了 Vehicle ;他们之间的关系为实现关系，用带空心箭头的虚线表示；
- SUV 继承了 Car；他们之间的关系为泛化关系，用带空心箭头的实线表示；
- Car 与 Tire、Engine 为组合关系，用带实心菱形的实线表示；
- Employee 与 Company 为聚合关系，用带空心菱形的虚线表示；
- Employee 与 Badge 为关联关系，用一根实线表示；
- Employee 上班需要骑自行车，他们之间是依赖关系，用带箭头的虚线表示；

在UML类图中，类之间，接口之间，类与接口之间有以下几种关系。

#### 泛化关系(generalization)

泛化关系是类与类，接口与接口之间常见的关系，在 Java中通过 extends 关键字表示。

泛化关系用一条带空心箭头的直线表示；如下图表示（Suv 继承自 Car）

![泛化关系](https://rgl-1252211075.cos.ap-beijing.myqcloud.com/uml/extends.png)

### 实现关系

实现关系是类与接口最常见的关系，在 Java 中通过 implements 关键字来表示。

实现关系用一条带空心箭头的虚线表示；如下图表示（ Bike 和 Car 实现了 Vehicle）

![实现关系](https://rgl-1252211075.cos.ap-beijing.myqcloud.com/uml/implements.png)

### 聚合关系(aggregation)

聚合关系用于表示实体对象之间的关系，表示整体由部分构成；例如一个公司由多个员工组成。

与组合关系不同的是，整体和部分不是强依赖的，即使整体不存在了，部分仍然存在；例如，公司倒闭了，员工不会消失，他们依然存在；

聚合关系用一条带空心菱形箭头的实线表示，如下图表示 Employee 聚合到 Company 上，或者说 Company 由 Employee 组成；

![聚合关系](https://rgl-1252211075.cos.ap-beijing.myqcloud.com/uml/aggregation.png)

### 组合关系(composition)

与聚合关系一样，组合关系同样表示整体由部分构成的语义；比如公司由多个部门组成；

组合关系是一种强依赖的特殊聚合关系，如果整体不存在了，则部分也不存在了；例如， 公司不存在了，部门也将不存在了；

组合关系用一条带实心菱形箭头的实线表示；如下图所示( Car 有 Engine 和 Tire 组成)

![组合关系](https://rgl-1252211075.cos.ap-beijing.myqcloud.com/uml/composition.png)

### 关联关系(association)

关联关系是用一条直线表示的；它描述不同类的对象之间的结构关系；它是一种静态关系， 通常与运行状态无关，一般由常识等因素决定的；它一般用来定义对象之间静态的、天然的结构；所以，关联关系是一种“强关联”的关系；

比如，员工和工牌之间就是一种关联关系；

关联关系默认不强调方向，表示对象间相互知道；如果特别强调方向，如下图，表示 A 知道 B，但 B 不知道 A；

![关联关系](https://rgl-1252211075.cos.ap-beijing.myqcloud.com/uml/association.png)

> 在代码中，关联对象通常是以成员变量的形式实现的；

### 依赖关系(dependency)

依赖关系是用一套带箭头的虚线表示的；如下图表示 Employee 上班依赖于自行车；他描述一个对象在运行期间会用到另一个对象的关系；

![关联关系](https://rgl-1252211075.cos.ap-beijing.myqcloud.com/uml/dependency.png)

与关联关系不同的是，它是一种临时性的关系，通常在运行期间产生，并且随着运行时的变化； 依赖关系也可能发生变化；依赖也有方向，双向依赖是一种非常糟糕的结构，我们总是应该保持单向依赖，杜绝双向依赖的产生；

> 在代码中，依赖关系体现为类构造方法及类方法的传入参数，箭头的指向为调用关系；依赖关系除了临时知道对方外，还是“使用”对方的方法和属性；

对于继承、实现这两种关系没多少疑问，他们体现的是一种类与类、或者类与接口间的纵向关系；其他的四者关系则体现的是类与类、或者类与接口间的引用、横向关系，是比较难区分的，有很多事物间的关系要想准备定位是很难的，前面也提到，这几种关系都是语义级别的，所以从代码层面并不能完全区分各种关系；但总的来说，后几种关系所表现的强弱程度依次为：组合>聚合>关联>依赖

### 参考链接

[看懂UML类图和时序图](http://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html#uml)

[UML解惑：图说UML中的六大关系](http://www.uml.org.cn/oobject/201006114.asp)

